<div class="row">
  <div class="col-md-8 offset-md-2">
    <h1>Import Details #<%= @import.id %></h1>
    
    <%= link_to "Back to Imports", imports_path, class: "btn btn-secondary mb-3" %>
    
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          Import Information
          <% case @import.status %>
          <% when 'pending' %>
            <span class="badge bg-secondary float-end">Pending</span>
          <% when 'processing' %>
            <span class="badge bg-info float-end">Processing</span>
          <% when 'completed' %>
            <span class="badge bg-success float-end">Completed</span>
          <% when 'failed' %>
            <span class="badge bg-danger float-end">Failed</span>
          <% end %>
        </h5>
      </div>
      <div class="card-body">
        <dl class="row">
          <dt class="col-sm-4">Filename:</dt>
          <dd class="col-sm-8"><%= @import.filename %></dd>
          
          <dt class="col-sm-4">Email:</dt>
          <dd class="col-sm-8"><%= @import.user_email %></dd>
          
          <dt class="col-sm-4">Started At:</dt>
          <dd class="col-sm-8"><%= @import.created_at.strftime("%Y-%m-%d %H:%M:%S") %></dd>
          
          <% if @import.completed_at %>
            <dt class="col-sm-4">Completed At:</dt>
            <dd class="col-sm-8"><%= @import.completed_at.strftime("%Y-%m-%d %H:%M:%S") %></dd>
            
            <dt class="col-sm-4">Duration:</dt>
            <dd class="col-sm-8"><%= (@import.duration).round(2) %> seconds</dd>
          <% end %>
        </dl>
        
        <% if @import.status == 'completed' %>
          <hr>
          <h6>Statistics</h6>
          <div class="row text-center">
            <div class="col-md-3">
              <div class="card bg-light">
                <div class="card-body">
                  <h3 class="text-primary"><%= @import.total_rows %></h3>
                  <p class="mb-0">Total Rows</p>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card bg-light">
                <div class="card-body">
                  <h3 class="text-success"><%= @import.created_count %></h3>
                  <p class="mb-0">Created</p>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card bg-light">
                <div class="card-body">
                  <h3 class="text-warning"><%= @import.skipped_count %></h3>
                  <p class="mb-0">Skipped</p>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="card bg-light">
                <div class="card-body">
                  <h3 class="text-info"><%= @import.success_rate %>%</h3>
                  <p class="mb-0">Success Rate</p>
                </div>
              </div>
            </div>
          </div>
        <% end %>
        
        <% if @import.errors.present? %>
          <hr>
          <h6 class="text-danger">Errors</h6>
          <div class="alert alert-warning">
            <pre class="mb-0" style="max-height: 300px; overflow-y: auto;"><%= @import.errors %></pre>
          </div>
        <% end %>
        
        <% if @import.status == 'processing' %>
          <div class="alert alert-info mt-3">
            <div class="spinner-border spinner-border-sm me-2" role="status">
              <span class="visually-hidden">Processing...</span>
            </div>
            Import is currently being processed. Please refresh the page to see updates.
          </div>
          <script>
            setTimeout(function() {
              location.reload();
            }, 5000);
          </script>
        <% end %>
      </div>
    </div>
  </div>
</div>