<!DOCTYPE html>
<html>
<head>
  <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      color: #333;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
    }
    .header {
      background-color: #0d6efd;
      color: white;
      padding: 20px;
      text-align: center;
    }
    .content {
      background-color: #f8f9fa;
      padding: 20px;
      margin-top: 20px;
    }
    .stats {
      display: flex;
      justify-content: space-around;
      margin: 20px 0;
    }
    .stat-box {
      background-color: white;
      padding: 15px;
      border-radius: 5px;
      text-align: center;
      flex: 1;
      margin: 0 5px;
    }
    .stat-number {
      font-size: 24px;
      font-weight: bold;
    }
    .success { color: #198754; }
    .warning { color: #ffc107; }
    .danger { color: #dc3545; }
    .info { color: #0dcaf0; }
    .errors {
      background-color: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin-top: 20px;
    }
    .footer {
      text-align: center;
      padding: 20px;
      color: #6c757d;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Book Import Report</h1>
      <p>Import #<%= @import.id %></p>
    </div>

    <div class="content">
      <h2>Import Details</h2>
      <p><strong>Filename:</strong> <%= @import.filename %></p>
      <p><strong>Status:</strong> 
        <% case @import.status %>
        <% when 'completed' %>
          <span class="success">✓ COMPLETED</span>
        <% when 'failed' %>
          <span class="danger">✗ FAILED</span>
        <% else %>
          <%= @import.status.upcase %>
        <% end %>
      </p>
      
      <% if @import.completed_at %>
        <p><strong>Started:</strong> <%= @import.created_at.strftime("%Y-%m-%d %H:%M:%S") %></p>
        <p><strong>Completed:</strong> <%= @import.completed_at.strftime("%Y-%m-%d %H:%M:%S") %></p>
        <p><strong>Duration:</strong> <%= (@import.duration).round(2) %> seconds</p>
      <% end %>

      <% if @import.status == 'completed' %>
        <h3 style="margin-top: 30px;">Statistics</h3>
        <div class="stats">
          <div class="stat-box">
            <div class="stat-number"><%= @import.total_rows %></div>
            <div>Total Rows</div>
          </div>
          <div class="stat-box">
            <div class="stat-number success"><%= @import.created_count %></div>
            <div>Created</div>
          </div>
          <div class="stat-box">
            <div class="stat-number warning"><%= @import.skipped_count %></div>
            <div>Skipped</div>
          </div>
          <div class="stat-box">
            <div class="stat-number info"><%= @import.success_rate %>%</div>
            <div>Success Rate</div>
          </div>
        </div>
      <% end %>

      <% if @import.errors.present? %>
        <div class="errors">
          <h3>Errors</h3>
          <pre style="white-space: pre-wrap;"><%= @import.errors %></pre>
        </div>
      <% end %>
    </div>

    <div class="footer">
      <p>This is an automated message from Bookshelf Application</p>
      <p><a href="<%= root_url %>">Visit Bookshelf</a></p>
    </div>
  </div>
</body>
</html>